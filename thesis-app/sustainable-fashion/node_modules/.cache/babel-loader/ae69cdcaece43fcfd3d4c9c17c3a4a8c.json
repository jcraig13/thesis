{"ast":null,"code":"import * as d3 from \"d3\";\nconst margin = 20;\nconst DEFAULT_FORECAST = \"Hover for Forecast\";\nexport default {\n  name: \"CountriesStep\",\n\n  data() {\n    return {\n      days: 7,\n      shortForecast: DEFAULT_FORECAST\n    };\n  },\n\n  props: {\n    data: Array,\n    height: Number,\n    width: Number\n  },\n  computed: {\n    xScale() {\n      return d3.scaleBand().padding(0.1).domain(this.data.map(d => d.name)).range([0, this.width]);\n    },\n\n    yScale() {\n      return d3.scaleLinear().domain([Math.min(0, d3.min(this.data, d => d.temperature)), d3.max(this.data, d => d.temperature)]).range([0, this.height - margin]);\n    },\n\n    rectWidth() {\n      return this.xScale.bandwidth();\n    }\n\n  },\n\n  updated() {\n    const that = this;\n    d3.select(\".bars\").selectAll(\"g.bar\").data((this.data || []).slice(0, this.days)).join(enter => {\n      const bar = enter.append(\"g\").attr(\"class\", \"bar\");\n      const rect = bar.append(\"rect\").attr(\"width\", this.rectWidth).attr(\"height\", 0).attr(\"y\", this.height).attr(\"x\", d => this.xScale(d.name)).attr(\"fill\", \"lightblue\");\n      rect.transition().delay((_, i) => i * 50).attr(\"y\", d => this.height - this.yScale(d.temperature)).attr(\"height\", d => this.yScale(d.temperature));\n      const nameText = bar.append(\"text\").attr(\"class\", \"name-text\").attr(\"y\", this.height + this.rectWidth).attr(\"x\", d => this.xScale(d.name)).attr(\"transform\", d => `rotate(-90 ${this.xScale(d.name)} ${this.height})`).attr(\"opacity\", 0).text(d => d.name);\n      nameText.transition().attr(\"opacity\", 1);\n      const tempText = bar.append(\"text\").attr(\"class\", \"temp-text\").attr(\"text-anchor\", \"middle\").attr(\"x\", d => this.xScale(d.name) + this.rectWidth / 2).attr(\"y\", this.height).text(d => d.temperature);\n      tempText.transition().delay((_, i) => 100 + i * 50).attr(\"y\", d => this.height - this.yScale(d.temperature) - 5);\n      return bar;\n    }, update => {\n      update.select(\"rect\").attr(\"fill\", \"lightgreen\").attr(\"width\", this.rectWidth).attr(\"x\", d => this.xScale(d.name));\n      update.select(\".name-text\").attr(\"y\", this.height + this.rectWidth).attr(\"x\", d => this.xScale(d.name)).attr(\"transform\", d => `rotate(-90 ${this.xScale(d.name)} ${this.height})`);\n      update.select(\".temp-text\").attr(\"x\", d => this.xScale(d.name) + this.rectWidth / 2);\n      return update;\n    }, exit => {\n      exit.select(\"rect\").transition().attr(\"height\", 0).attr(\"y\", this.height).on(\"end\", () => {\n        exit.remove();\n      });\n      exit.select(\"text\").transition().attr(\"opacity\", 0);\n    }).on(\"mouseenter\", (event, d) => {\n      that.shortForecast = d.shortForecast;\n    }).on(\"mouseleave\", () => {\n      that.shortForecast = DEFAULT_FORECAST;\n    });\n  }\n\n};","map":{"version":3,"mappings":"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","names":["d3","margin","DEFAULT_FORECAST","name","data","days","shortForecast","props","Array","height","Number","width","computed","xScale","scaleBand","padding","domain","map","d","range","yScale","scaleLinear","Math","min","temperature","max","rectWidth","bandwidth","updated","that","select","selectAll","slice","join","enter","bar","append","attr","rect","transition","delay","_","i","nameText","text","tempText","update","exit","on","remove","event"],"sourceRoot":"","sources":["/Users/juliet/Documents/GitHub/thesis/thesis-app/sustainable-fashion/src/components/CountriesStep.vue"],"sourcesContent":["<template>\n  <div>\n    <div class=\"slider\">\n      <label for=\"days-slider\">Number of forecasts to show:</label>\n    </div>\n    <div>{{ shortForecast }}</div>\n    <svg :height=\"height\" :width=\"width\">\n      <g class=\"bars\" />\n    </svg>\n  </div>\n</template>\n\n<script>\nimport * as d3 from \"d3\";\n\nconst margin = 20;\n\nconst DEFAULT_FORECAST = \"Hover for Forecast\";\n\nexport default {\n  name: \"CountriesStep\",\n  data() {\n    return {\n      days: 7,\n      shortForecast: DEFAULT_FORECAST,\n    };\n  },\n  props: {\n    data: Array,\n    height: Number,\n    width: Number,\n  },\n  computed: {\n    xScale() {\n      return d3\n        .scaleBand()\n        .padding(0.1)\n        .domain(this.data.map((d) => d.name))\n        .range([0, this.width]);\n    },\n    yScale() {\n      return d3\n        .scaleLinear()\n        .domain([\n          Math.min(\n            0,\n            d3.min(this.data, (d) => d.temperature)\n          ),\n          d3.max(this.data, (d) => d.temperature),\n        ])\n        .range([0, this.height - margin]);\n    },\n    rectWidth() {\n      return this.xScale.bandwidth();\n    },\n  },\n  updated() {\n    const that = this;\n    d3.select(\".bars\")\n      .selectAll(\"g.bar\")\n      .data((this.data || []).slice(0, this.days))\n      .join(\n        (enter) => {\n          const bar = enter.append(\"g\").attr(\"class\", \"bar\");\n          const rect = bar\n            .append(\"rect\")\n            .attr(\"width\", this.rectWidth)\n            .attr(\"height\", 0)\n            .attr(\"y\", this.height)\n            .attr(\"x\", (d) => this.xScale(d.name))\n            .attr(\"fill\", \"lightblue\");\n          rect\n            .transition()\n            .delay((_, i) => i * 50)\n            .attr(\"y\", (d) => this.height - this.yScale(d.temperature))\n            .attr(\"height\", (d) => this.yScale(d.temperature));\n\n          const nameText = bar\n            .append(\"text\")\n            .attr(\"class\", \"name-text\")\n            .attr(\"y\", this.height + this.rectWidth)\n            .attr(\"x\", (d) => this.xScale(d.name))\n            .attr(\n              \"transform\",\n              (d) => `rotate(-90 ${this.xScale(d.name)} ${this.height})`\n            )\n            .attr(\"opacity\", 0)\n            .text((d) => d.name);\n          nameText.transition().attr(\"opacity\", 1);\n\n          const tempText = bar\n            .append(\"text\")\n            .attr(\"class\", \"temp-text\")\n            .attr(\"text-anchor\", \"middle\")\n            .attr(\"x\", (d) => this.xScale(d.name) + this.rectWidth / 2)\n            .attr(\"y\", this.height)\n            .text((d) => d.temperature);\n          tempText\n            .transition()\n            .delay((_, i) => 100 + i * 50)\n            .attr(\"y\", (d) => this.height - this.yScale(d.temperature) - 5);\n\n          return bar;\n        },\n        (update) => {\n          update\n            .select(\"rect\")\n            .attr(\"fill\", \"lightgreen\")\n            .attr(\"width\", this.rectWidth)\n            .attr(\"x\", (d) => this.xScale(d.name));\n          update\n            .select(\".name-text\")\n            .attr(\"y\", this.height + this.rectWidth)\n            .attr(\"x\", (d) => this.xScale(d.name))\n            .attr(\n              \"transform\",\n              (d) => `rotate(-90 ${this.xScale(d.name)} ${this.height})`\n            );\n          update\n            .select(\".temp-text\")\n            .attr(\"x\", (d) => this.xScale(d.name) + this.rectWidth / 2);\n          return update;\n        },\n        (exit) => {\n          exit\n            .select(\"rect\")\n            .transition()\n            .attr(\"height\", 0)\n            .attr(\"y\", this.height)\n            .on(\"end\", () => {\n              exit.remove();\n            });\n          exit.select(\"text\").transition().attr(\"opacity\", 0);\n        }\n      )\n      .on(\"mouseenter\", (event, d) => {\n        that.shortForecast = d.shortForecast;\n      })\n      .on(\"mouseleave\", () => {\n        that.shortForecast = DEFAULT_FORECAST;\n      });\n  },\n};\n</script>\n\n<style>\n.slider {\n  max-width: 50%;\n  margin: 0 auto;\n}\ninput[type=\"range\"]::-webkit-slider-thumb {\n  cursor: ew-resize; /* grab */\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}